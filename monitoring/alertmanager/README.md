<!-- 
---
title: "AlertManager - Notification & Alerting System"
description: "Documentation for the AlertManager component of the monitoring stack, including alerting structure, notification flow, and integration status"
author: "VintageDon"
tags: ["alertmanager", "monitoring", "alerting", "notifications", "prometheus", "teams", "email"]
kb_type: "Service Document"
version: "1.0"
status: "Draft"
last_updated: "2025-04-04"
related_services: ["Prometheus", "Grafana", "Loki", "Teams Integration"]
implements_policies: ["Monitoring Policy", "Incident Response Policy"]
phase: "phase-2"
---
-->

# üîî **AlertManager - Notification & Alerting System**

# üîç **1. Overview**

AlertManager serves as the central notification and alerting component within the Proxmox Astronomy Lab's monitoring stack, responsible for receiving, processing, and routing alerts generated by Prometheus and other monitoring systems to appropriate notification channels. This service ensures that operational issues are detected, categorized, and escalated to the right personnel in a timely manner.

The current AlertManager implementation focuses on email-based notifications with validated (but not yet fully deployed) Microsoft Teams integration. It handles alerts for infrastructure health, service availability, system performance, and security events across the entire lab environment.

---

# üö® **2. Alert Categories & Notification Flow**

## **2.1 Alert Categories**

Alerts are organized into logical categories based on their impact, severity, and relevant infrastructure components.

| **Category** | **Examples** | **Severity** | **Notification Method** |
|-------------|-------------|------------|------------------|
| **Infrastructure Health** | Node down, VM offline | Critical | Email, Teams (Planned) |
| **Service Availability** | Web UI down, API unreachable | High | Email, Teams (Planned) |
| **System Performance** | High CPU, disk full | Medium | Email |
| **Security Events** | Multiple failed logins, banned IPs | High | Email, SIEM (Planned) |
| **Networking Issues** | High latency, SNMP device offline | Medium | Email |

## **2.2 Alert Notification Flow**

The alert processing sequence ensures proper evaluation, routing, and delivery of notifications.

1. **Prometheus detects an issue** and generates an alert.
2. **AlertManager evaluates severity** and routes it accordingly.
3. **Email notification is sent** to administrators.
4. *(Future)* **Teams Adaptive Cards trigger structured triage.**
5. *(Future)* **Escalation workflows activate for critical issues.**

---

# üìä **3. Alerting Configuration by System Type**

## **3.1 Proxmox Nodes & VM Infrastructure**

Monitoring and alerting for virtualization infrastructure components.

| **Alert Type** | **Trigger Condition** | **Notification** |
|--------------|-----------------|-----------------|
| Node Down | No response for 5 min | Critical (Email) |
| High CPU Usage | >90% sustained for 30 min | Medium (Email) |
| Disk Full | <5% free space remaining | High (Email) |

## **3.2 Kubernetes Nodes & Containers**

Monitoring and alerting for containerized workloads and orchestration.

| **Alert Type** | **Trigger Condition** | **Notification** |
|--------------|-----------------|-----------------|
| K8s Node Not Ready | Node unresponsive | Critical (Email) |
| Pod Restart Loops | >5 restarts in 10 min | Medium (Email) |
| High Container Memory | >85% memory usage | Medium (Email) |

## **3.3 Applications & Services**

Monitoring and alerting for application-level components and services.

| **Alert Type** | **Service** | **Trigger Condition** | **Notification** |
|--------------|----------|-----------------|-----------------|
| Web UI Unavailable | Grafana, Portainer | HTTP check fails | High (Email) |
| Database Query Latency | PostgreSQL | Query time > 2s | Medium (Email) |
| API Failure | Nextcloud, Vault | Endpoint unreachable | High (Email) |

## **3.4 Network & Security Monitoring**

Monitoring and alerting for network infrastructure and security events.

| **Alert Type** | **Trigger Condition** | **Notification** |
|--------------|-----------------|-----------------|
| High Latency | Response time > 500ms | Medium (Email) |
| SNMP Device Down | No response for 5 min | High (Email) |
| Multiple Failed Logins | >10 failures in 5 min | High (Email) |
| Fail2Ban IP Ban | IP banned due to brute-force | Medium (Email) |

---

# üë• **4. Teams Integration (Planned)**

## **4.1 Power Automate Integration**

The Microsoft Teams integration is designed to enhance alert visibility and response capabilities.

| **Feature** | **Status** | **Implementation Details** |
|------------|-----------|---------------------------|
| **Adaptive Cards** | Validated | Interactive cards replacing email notifications |
| **Response Actions** | Validated | Acknowledge, Resolve, and Escalate buttons |
| **Channel Routing** | Validated | Alerts automatically routed to appropriate Teams channels |

## **4.2 Teams Notification Channels**

Alert notifications are structured into dedicated Microsoft Teams channels for better organization and response.

| **Channel** | **Purpose** |
|------------|------------|
| **General** | General announcements and monitoring discussions |
| **Apps** | Alerts related to applications and services |
| **Cluster** | Alerts from Proxmox cluster and Kubernetes nodes |
| **Logs** | Log-related alerts and aggregation from Loki |
| **Misc** | Catch-all for alerts that don't fit other categories |
| **Pipelines** | CI/CD and automation pipeline alerts |
| **Security** | Security-related alerts and SIEM notifications |
| **VMs** | Alerts for individual virtual machines |

---

# üîÑ **5. Implementation Status**

Current status and next steps for the AlertManager implementation.

| **Component** | **Status** | **Next Steps** |
|--------------|-----------|----------------|
| **Basic Email Alerting** | ‚úÖ Complete | Refine alert thresholds |
| **Teams Integration** | ‚úÖ Validated | Complete production deployment |
| **Alert Routes & Grouping** | ‚úÖ Complete | Add additional categorization |
| **Escalation Workflows** | ‚è≥ Planned | Implement in Phase 3 |
| **AI-Driven Alert Correlation** | ‚è≥ Planned | Research for Phase 4 |

---

# üîó **6. Directory Contents**

This section provides direct navigation to key related documents:

## **Key Documents**

| **Document** | **Purpose** | **Link** |
|--------------|------------|----------|
| **AlertManager Configuration** | Technical configuration details | [AlertManager Configuration](/monitoring/alertmanager/configuration.yml) |
| **Teams Integration Setup** | Power Automate workflow documentation | [Teams Integration](/monitoring/teams-integration/README.md) |
| **Alert Rules** | Prometheus alert rule definitions | [Alert Rules](/monitoring/prometheus/alert-rules.yml) |

---

# üîÑ **7. Related Categories**

| **Category** | **Relationship** | **Link** |
|--------------|----------------|----------|
| **Prometheus** | Alert source and rules engine | [Prometheus Documentation](/monitoring/prometheus/README.md) |
| **Grafana** | Alert visualization and dashboards | [Grafana Documentation](/monitoring/grafana/README.md) |
| **Loki** | Log-based alerting integration | [Loki Documentation](/monitoring/loki/README.md) |
| **Infrastructure** | Monitored systems generating alerts | [Infrastructure Documentation](/infrastructure/README.md) |
| **ITIL Processes** | Incident management integration | [ITIL Documentation](/docs/ITIL-Processes/Incident-Management/README.md) |

---

# ‚úÖ **8. Approval & Review**

| **Reviewer** | **Role** | **Approval Date** | **Status** |
|-------------|---------|------------------|------------|
| VintageDon | Lead Engineer | 2025-04-04 | ‚è≥ In Progress |

---

# üìú **9. Change Log**

| **Version** | **Date** | **Changes** | **Author** |
|------------|---------|-------------|------------|
| 1.0 | 2025-04-04 | Structured README for AlertManager | VintageDon |
