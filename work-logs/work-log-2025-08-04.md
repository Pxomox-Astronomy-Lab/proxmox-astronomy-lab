# **Enterprise Identity & Infrastructure Integration Initiative**

**Date Range:** Saturday, August 3, 2025 â€“ Sunday, August 4, 2025  
**Engineer:** crainbramp  
**Project:** Proxmox Astronomy Lab - Hybrid Identity & Platform Integration  
**Total Time:** ~9-10 hours (Two 4-5 hour sessions)

## **Table of Contents**

1. [Executive Summary](#1-executive-summary)
2. [Key Workstreams and Accomplishments](#2-key-workstreams-and-accomplishments)

- [**Enterprise Identity \& Infrastructure Integration Initiative**](#enterprise-identity--infrastructure-integration-initiative)
  - [**Table of Contents**](#table-of-contents)
  - [**1. Executive Summary**](#1-executive-summary)
  - [**2. Key Workstreams and Accomplishments**](#2-key-workstreams-and-accomplishments)
    - [**Workstream 1: VDI Infrastructure \& Hybrid Identity Integration**](#workstream-1-vdi-infrastructure--hybrid-identity-integration)
    - [**Workstream 2: File Services \& Storage Infrastructure**](#workstream-2-file-services--storage-infrastructure)
    - [**Workstream 3: Azure Arc \& Cloud Security Integration**](#workstream-3-azure-arc--cloud-security-integration)
    - [**Workstream 4: Intune Enterprise Device Management**](#workstream-4-intune-enterprise-device-management)
    - [**Workstream 5: Licensing \& Identity Management**](#workstream-5-licensing--identity-management)
    - [**Workstream 6: Conditional Access Policy Restructure**](#workstream-6-conditional-access-policy-restructure)
    - [**Workstream 7: Internal SSL \& Reverse Proxy Infrastructure**](#workstream-7-internal-ssl--reverse-proxy-infrastructure)
    - [**Workstream 8: SSO Integration for Internal Platforms**](#workstream-8-sso-integration-for-internal-platforms)
    - [**Workstream 9: Cloud Platform Integration \& Monitoring**](#workstream-9-cloud-platform-integration--monitoring)
    - [**Workstream 10: AWS \& Backup Infrastructure**](#workstream-10-aws--backup-infrastructure)
    - [**Workstream 11: Microsoft Teams \& Collaboration Infrastructure**](#workstream-11-microsoft-teams--collaboration-infrastructure)
    - [**Workstream 12: Azure DevOps Experimental Platform**](#workstream-12-azure-devops-experimental-platform)
    - [**Workstream 13: Kasm Workspaces \& Web-Based VDI**](#workstream-13-kasm-workspaces--web-based-vdi)
    - [**Workstream 14: GPU Infrastructure \& AI/ML Services**](#workstream-14-gpu-infrastructure--aiml-services)
  - [**3. Integration \& Strategic Impact**](#3-integration--strategic-impact)

3. [Integration & Strategic Impact](#3-integration--strategic-impact)

## **1. Executive Summary**

This weekend initiative successfully implemented comprehensive hybrid identity integration and supporting infrastructure for the Proxmox Astronomy Lab enterprise platform. The work centered on deploying Windows 11 VDI infrastructure with seamless Azure AD hybrid join, establishing enterprise-grade device management through Intune, and integrating cloud security monitoring across Azure and GitHub platforms. Key accomplishments include full VDI deployment with SSO integration, Azure Arc server onboarding with Defender for Cloud, comprehensive Intune policy deployment, and foundational AI/ML infrastructure with shared GPU services.

## **2. Key Workstreams and Accomplishments**

### **Workstream 1: VDI Infrastructure & Hybrid Identity Integration**

**Goal:** Deploy production Windows 11 VDI environment with seamless Azure AD hybrid join and SSO capabilities.

**Actions Performed:**

1. **Azure AD Connect & Hybrid Join Setup:**
   - Configured tenancy for hybrid join, seamless SSO, device and password writeback via Azure Connect Sync
   - Set GPO for automatic domain join of new VDI instances

2. **VDI Deployment:**
   - Setup and hybrid joined radio-vdi01 through radio-vdi06
   - Configuration: Win11Pro/4c/16G/125G(C:), host CPU with Intel IOMMU
   - Special configuration: vdi06 = test instance, test VM = 2c/6G/125G(C:)

3. **Staff Onboarding Verification:**
   - All staff accounts signed in to VDIs and basic onboarding completed
   - Seamless SSO functionality verified across all instances
   - MobaXterm setup for all staff with login sharing, divided into L1/L2/L3 tiers

**Strategic Impact:** Established production-ready Windows desktop environment with enterprise identity integration.

### **Workstream 2: File Services & Storage Infrastructure**

**Goal:** Deploy high-availability distributed file system for enterprise data sharing.

**Actions Performed:**

1. **DFS Implementation:**
   - Setup fs02/fs04 as HA DFS share with 1TB NVMe capacity each
   - Created 3 initial shares: staff, development, research
   - Configured as //radioastronomy.io/data01/<share> with appropriate group permissions
   - Implemented DFS replication on VLAN50, vmbr1 (10G LACP)

2. **Group Policy Integration:**
   - Setup GPO for mapped drives by group membership
   - Integrated with existing Active Directory security group structure

**Strategic Impact:** Provided enterprise-grade file sharing with high availability and role-based access control.

### **Workstream 3: Azure Arc & Cloud Security Integration**

**Goal:** Onboard all Windows servers to Azure Arc with comprehensive monitoring and security capabilities.

**Actions Performed:**

1. **Azure Arc Onboarding:**
   - Cleaned up all old server registrations
   - Onboarded all new Windows Server 2025 Standard servers
   - Installed comprehensive extension suite: monitoring, patching, inventory/change management, OpenSSH
   - Enabled periodic update checks across all Arc-managed servers

2. **Defender for Cloud Implementation:**
   - Installed and configured Defender for Cloud on all Arc servers
   - Enabled all available E5/P2 security features
   - Integrated with existing security monitoring infrastructure

3. **Cloud Security Assessment:**
   - Reviewed CASB reports from Cloudflare on Azure/GitHub integrations
   - Reviewed Azure Security Report and created prioritized remediation list
   - Documented low-hanging fruit security improvements for immediate implementation

**Strategic Impact:** Established comprehensive cloud security monitoring and management for hybrid infrastructure.

### **Workstream 4: Intune Enterprise Device Management**

**Goal:** Deploy comprehensive device management and security baseline through Microsoft Intune.

**Actions Performed:**

1. **Security Baseline Implementation:**
   - Intune baseline security setup: BitLocker, firewall, antivirus, automated updates
   - Deployed standardized security configuration across all managed devices

2. **Application Management:**
   - Configured auto-installation of standard software suite: O365/Office, Notepad++, Adobe DC Reader, PowerShell 7, Git, 7-Zip, MobaXTerm, Bitwarden extension, HeidiSQL, Visual Studio Code, WinMerge, WizTree,
   - Setup automated installation of endpoint tools: prometheus node exporter (metrics), grafana alloy agent (logging), Wazuh agent (XDR)
   - Configured Bitwarden extension deployment pointing to on-premises Vaultwarden instance

3. **Browser & Productivity Configuration:**
   - Setup Edge bookmarks for all cluster services/UIs
   - Configured Kerberos on-premises helper for seamless authentication
   - Integrated auto-join GPO setup for streamlined device onboarding

**Strategic Impact:** Established enterprise-grade device management with automated security and productivity configurations.

### **Workstream 5: Licensing & Identity Management**

**Goal:** Implement proper Microsoft 365 licensing structure with multi-factor authentication requirements.

**Actions Performed:**

1. **License Procurement & Assignment:**
   - Purchased P2 license and assigned to radioazadmin for Intune licensing capabilities
   - Purchased F3 licenses for all staff members and completed assignments
   - Setup testing user with F3 license: <tester.testerino@radioastronomy.io>

2. **Multi-Factor Authentication Deployment:**
   - All users setup with TOTP using Bitwarden Authenticator
   - MFA credentials saved to Vaultwarden with dual ownership (admin and user)
   - Integrated MFA requirements with existing conditional access framework

3. **Administrative Access Management:**
   - Granted eligible Intune Administrator role to crainbramp@ to ease device joining processes
   - Updated Vaultwarden with all database passwords, user passwords, and service credentials

**Strategic Impact:** Established proper licensing compliance with robust multi-factor authentication across all user accounts.

### **Workstream 6: Conditional Access Policy Restructure**

**Goal:** Implement three-tier authentication strength model aligned with operational support structure.

**Actions Performed:**

1. **Policy Review & Analysis:**
   - Comprehensive review of existing conditional access policies
   - Identified gaps and inconsistencies in current authentication requirements

2. **Three-Tier Structure Implementation:**
   - Modified conditional access policies for 3-tier MFA structure:
     - L1 (HelpDesk): Standard MFA requirements
     - L2 (Operations): Enhanced authentication with device compliance
     - L3 (Engineering): Maximum security with hardware token requirements
   - Aligned authentication strength with operational responsibilities and risk levels

**Strategic Impact:** Established risk-based authentication framework matching operational support tiers.

### **Workstream 7: Internal SSL & Reverse Proxy Infrastructure**

**Goal:** Deploy comprehensive SSL certificate management and reverse proxy capabilities for internal services.

**Actions Performed:**

1. **Nginx Proxy Manager Deployment:**
   - Setup Nginx Proxy Manager for centralized reverse proxy management
   - Configured *.radioastronomy.io wildcard certificates via LetsEncrypt + Cloudflare DNS challenge
   - Automated certificate renewal and management processes

2. **Service Integration:**
   - Created reverse SSL proxies for critical internal services: Gitea, Portainer, PgAdmin4
   - Configured SSL termination and backend service routing
   - Implemented security headers and access controls

**Strategic Impact:** Established enterprise-grade SSL management with automated certificate provisioning for internal services.

### **Workstream 8: SSO Integration for Internal Platforms**

**Goal:** Integrate Azure AD authentication across all internal management platforms.

**Actions Performed:**

1. **Platform SSO Configuration:**
   - Setup SSO and mapped Azure groups for Portainer container management
   - Configured SSO integration for Gitea version control platform
   - Setup AD/LDAP authentication for Proxmox VE management interface

2. **Group Mapping & Access Control:**
   - Mapped existing Azure AD security groups to platform-specific roles
   - Implemented role-based access control aligned with three-tier operational model
   - Verified SSO functionality across all integrated platforms

**Strategic Impact:** Achieved unified authentication experience across all infrastructure management platforms.

### **Workstream 9: Cloud Platform Integration & Monitoring**

**Goal:** Establish cloud platform connectors and monitoring infrastructure for Azure, GitHub, and AWS integration.

**Actions Performed:**

1. **Cloud Security Connectors:**
   - Setup Entra connector for GitHub (security scanning and compliance monitoring)
   - Setup Entra connector for AWS storage accounts (identity and access management)
   - Initiated automated security scans and compliance reporting

2. **External Account Infrastructure:**
   - Setup shared mailboxes for external account creation: ops@, helpdeskteam@, opsteam@
   - Created service accounts at Cloudflare with tiered access: L3=Admin, L2=DNS edit, L1=read-only
   - All service account MFA configured with Bitwarden Authenticator, credentials stored in Vaultwarden

3. **SMTP & Notification Infrastructure:**
   - Purchased shared hosting account at WebDevote (DirectAdmin) for SMTP services ($10/year)
   - Setup <no-reply@radioastronomy.io> for system notifications and alerts
   - Integrated notification infrastructure with existing monitoring systems

**Strategic Impact:** Established comprehensive cloud platform integration with automated security monitoring and notification capabilities.

### **Workstream 10: AWS & Backup Infrastructure**

**Goal:** Implement AWS integration with comprehensive backup strategy for enterprise data protection.

**Actions Performed:**

1. **AWS Account Management:**
   - Setup AWS account fully configured for radioastronomy.io
   - Transferred account ownership to <ops@radioastronomy.io> for proper organizational control
   - Setup AWS IAM Identity Center with SSO integration via radioastronomy.io

2. **Backup Storage Implementation:**
   - Created backup buckets for Veeam: radiobackupsdeep (S3 Glacier Deep Archive), radiobackupsflex (S3 Glacier Flexible Retrieval)
   - Configured retention strategy: 4 weeks infrequent access, 1 monthly to deep archive
   - Setup Iperius Backup integration: daily/weekly to flexible retrieval, monthly to deep archive
   - Configured Veeam for Windows server backups (within 10 endpoint limit)
   - Planned integration with existing daily on-premises backups via pbs01

**Strategic Impact:** Established enterprise-grade cloud backup strategy complementing existing on-premises data protection.

### **Workstream 11: Microsoft Teams & Collaboration Infrastructure**

**Goal:** Deploy Microsoft Teams with organizational structure aligned with operational tiers.

**Actions Performed:**

1. **Teams Organization Setup:**
   - Setup Microsoft 365 Teams groups and channels for organizational structure
   - Created groups aligned with operational tiers: HelpDesk, Operations, Engineering
   - Established monitoring group for AlertManager webhook integration
   - Created sponsors group for external stakeholder communication

2. **Integration Planning:**
   - Configured webhook endpoints for monitoring system integration
   - Setup automated notification channels for infrastructure alerts and status updates

**Strategic Impact:** Established collaborative communication platform integrated with infrastructure monitoring and organizational structure.

### **Workstream 12: Azure DevOps Experimental Platform**

**Goal:** Evaluate Azure DevOps as project management and repository integration platform.

**Actions Performed:**

1. **Organization Setup:**
   - Setup Azure DevOps organization "radioastronomy" with crainbramp@ as owner
   - Invited all staff as basic users on free plan for evaluation
   - Created test repository for initial functionality testing
   - Setup local self-hosted runner on agents01 for build capabilities

2. **Integration Evaluation:**
   - Configured GitHub repository sync and issue integration features
   - Evaluated project management capabilities compared to current tools
   - Tested build pipeline functionality with self-hosted agent

**Strategic Impact:** Established evaluation platform for potential project management and CI/CD capabilities.

### **Workstream 13: Kasm Workspaces & Web-Based VDI**

**Goal:** Deploy web-based VDI streaming capabilities for enhanced remote access.

**Actions Performed:**

1. **Kasm Deployment:**
   - Installed and configured Kasm Workspaces platform
   - Setup web-streaming capabilities for vdi01-vdi06
   - Configured browser-based access to Windows desktop environments
   - Integrated with existing authentication and access control systems

**Strategic Impact:** Provided additional remote access capabilities with browser-based VDI streaming.

### **Workstream 14: GPU Infrastructure & AI/ML Services**

**Goal:** Deploy dedicated GPU infrastructure with shared AI/ML capabilities across the cluster.

**Actions Performed:**

1. **GPU Node Deployment:**
   - Setup newly provisioned proj-gpu01 on node07
   - Configuration: 8c/32GB RAM/32GB OS/500GB data storage
   - GPU passthrough: NVIDIA RTX A4000 16GB

2. **AI/ML Software Stack:**
   - Installed NVIDIA drivers and CUDA toolkit
   - Configured Multi-Process Service (MPS) server for shared GPU access
   - Deployed Ollama and supporting AI/ML software stack
   - Created service endpoints for Kubernetes and application integration

3. **Cluster Integration:**
   - Configured GPU services accessible across entire infrastructure
   - Established resource sharing mechanisms for ML workloads
   - Integrated with existing monitoring and resource management systems

**Strategic Impact:** Established centralized AI/ML infrastructure with shared GPU capabilities supporting research and development workloads.

## **3. Integration & Strategic Impact**

This comprehensive weekend initiative successfully transformed the Proxmox Astronomy Lab into a fully integrated enterprise platform with seamless hybrid identity, comprehensive security monitoring, and robust AI/ML capabilities. All workstreams integrated cohesively to support the three-tier operational model while maintaining research computing flexibility and enterprise-grade security standards.

The resulting architecture provides production-ready VDI infrastructure, automated device management, comprehensive cloud security integration, and foundational AI/ML services - establishing the platform for scaled research operations and team collaboration.
