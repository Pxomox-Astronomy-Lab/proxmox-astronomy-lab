### **Unified Worklog: Enterprise Infrastructure Maturation Initiative**

* **Date Range:** Friday, July 26, 2025 â€“ Sunday, July 28, 2025
* **Engineer:** crainbramp
* **Project:** Proxmox Astronomy Lab (P/AL) - Enterprise Upgrade

## 1. Executive Summary

This initiative successfully designed and deployed a multi-layered, defense-in-depth security architecture for the P/AL infrastructure. The work executed a comprehensive overhaul of the identity, access, and security-policy control planes. Key accomplishments include the deployment of a Zero Trust remote access model, the establishment of a dual-authorization IAM framework based on least privilege, the automated application of a CISv8-aligned secure configuration baseline derived from Tenable audit data, and the deployment of a comprehensive security operations and monitoring platform. The resulting architecture establishes clear, auditable security boundaries and systematically addresses numerous controls across the CIS and NIST frameworks, with a continuous verification capability now in place.

## 2. Key Workstreams and Accomplishments

### Workstream 1: Hybrid IAM & Cloud Access Control Framework

* **Goal:** To design and implement a cohesive identity framework across on-premises Active Directory and Azure AD, based on a tiered, least-privilege operational model.
* **Key Artifacts:**
  * `A Multi-Tiered Least Privilege Access Model for IT Support.pdf`
  * `ad_groups_implementation_worklog-2025-07-26.md`
  * `azure-rbac-cisv8-raw-config.md`
  * `azure-ad-connect_state_2025-07-26.md`

* **Actions Performed:**
    1. **Tiered Model Design:** A three-tiered (L1 HelpDesk, L2 Operations, L3 Engineering) operational support model was formally designed, as detailed in the *Multi-Tiered Least Privilege Access Model* report. This serves as the logical basis for all access control policies.
    2. **Dual-Authorization Group Structure:**
        * **On-Premises (`SGAD_*`):** As documented in `ad_groups_implementation_worklog`, scripted the creation of **41 standardized Active Directory security groups** to manage access to on-premises and hybrid resources. User membership is aligned with the three-tiered model.
        * **Cloud (`SGC_*`):** As detailed in `azure-rbac-cisv8-raw-config.md`, created a parallel set of **6 role-assignable security groups** in Azure AD, designed specifically for assigning permissions to Entra ID and Azure resources.
    3. **Custom Azure RBAC Development:** To enforce least privilege, **6 custom Azure RBAC roles** were created, with granular permissions tailored to each support tier. The full JSON definitions are captured in `azure-rbac-cisv8-raw-config.md`. These roles include:
        * `Platform Triage Operator` (L1)
        * `Platform Operations Specialist` (L2)
        * `Platform Engineer` (L3)
        * `Security Monitoring Analyst` (Sec L1)
        * `Incident Response Specialist` (Sec L2)
        * `Security Architect` (Sec L3)
    4. **Hybrid Identity Sync:** The Azure AD Connect configuration, recorded in `azure-ad-connect_state_2025-07-26.md`, was set to synchronize the new on-premises user and group structure to the cloud, enabling a single identity source for authentication and authorization.

* **Strategic Impact:** This dual-authorization system establishes a comprehensive IAM control plane, separating the management of hybrid identities from cloud-native permissions for precise, auditable, and role-based access control.

### Workstream 2: Zero Trust Network Access (ZTNA) Architecture

* **Goal:** To establish a secure, MFA-enforced remote access security boundary for all infrastructure assets, including all administrative protocols.
* **Key Artifacts:** `azure-ad-connect_state_2025-07-26.md` (SCIM config), `ad_groups_implementation_worklog-2025-07-26.md` (ZTNA group definitions)

* **Actions Performed:**
    1. **Secure Perimeter:** Deployed Cloudflare Tunnel as the **sole remote access vector** for the entire on-premises cluster. This ensures no inbound ports are exposed on the perimeter firewall.
    2. **Identity Provider Integration:** Configured SAML authentication and SCIM user/group provisioning between Cloudflare and Azure AD, linking network access directly to the central IAM framework.
    3. **Policy Enforcement:** Defined all **17 internal servers** and associated services (Proxmox, Gitea, Vaultwarden, etc.) as distinct applications within Cloudflare Access. Created granular access policies that grant access based on membership in the synced `SGAD_ZTNA_*` security groups. This explicitly includes administrative protocols like **SSH**, which now requires ZTNA authentication, enabling access via ephemeral, identity-based credentials.
    4. **MFA Enforcement:** The integration with Azure AD Conditional Access enforces strong MFA (YubiKey/Passwordless for privileged accounts) for all remote access attempts.

* **Strategic Impact:** This workstream established the primary Zero Trust security boundary for the infrastructure. All remote access is now explicitly identity-based, centrally managed, and rigorously audited through a single control point.

### Workstream 3: Automated Secure Configuration Baseline

* **Goal:** To apply a consistent, auditable, and verifiable CIS Level 1/Level 2 security baseline to all server assets.
* **Key Artifacts:**
  * `cisv8-gpo-naming-conventions.md`
  * `cis-server2025-gpos-l1-dc-and-members-IMPLEMENTATION-LOG.md`
  * `import_gpos.ps1.txt` & `CIS_W2025_L1_Baseline.csv`
  * `Ubuntu 24.04 LTS Server Golden Image Report.pdf`

* **Actions Performed:**
    1. **Control Derivation from Tenable:** The CIS controls for Windows Server were systematically reverse-engineered from Tenable audit files to ensure the implemented baseline directly maps to the compliance validation tooling.
    2. **Windows Baseline (GPO-as-Code):** An idempotent PowerShell script deployed the Windows baseline, creating **47 distinct GPOs**. These include:
        * **CIS04 (Secure Configuration):** 16 GPOs for App Installer, App Runtime, Autoplay, Logon settings, MS Security Guide policies, etc.
        * **CIS05 (Account Management):** 3 GPOs for Account Settings and SAM RPC restrictions.
        * **CIS06 (Access Control):** 4 GPOs for Anonymous access restrictions and credential delegation.
        * **CIS08 (Audit Log Management):** 2 GPOs for Time Synchronization.
        * **CIS12 (Network Infrastructure):** 11 GPOs for DNS Client, UNC paths, Lanman, SMBv1, and WinRM hardening.
    3. **Linux Baseline (Golden Image):** As documented in the Golden Image Report, all Linux servers are deployed from a CISv8 Level 2 hardened Ubuntu 24.04 template, achieving a **Lynis score of 86**.

* **Strategic Impact:** This ensures all servers maintain a consistent, hardened security posture that is verifiably compliant with industry benchmarks.

### Workstream 4: Security Operations & Continuous Monitoring Deployment

* **Goal:** To deploy a SIEM platform to establish continuous monitoring, compliance verification, and threat detection across all server assets.
* **Key Artifacts:** Wazuh screenshots, `dns_worklog_2025-07-27.md`, `dhcp_worklog_2025-07-27.md`

* **Actions Performed:**
    1. **Agent Deployment:** Deployed and activated **18 Wazuh agents** across the entire server infrastructure, covering all 17 primary servers and the domain controller.
    2. **Dual-Stack Logging Architecture:**
        * **Security (Wazuh):** Established a centralized platform for security events, Security Configuration Assessment (SCA), vulnerability detection, and File Integrity Monitoring (FIM).
        * **Performance (Prometheus/Grafana/Loki):** Leveraged the existing observability stack to collect system metrics, performance data, and application-level logs, providing operational context to security events.
    3. **Initial Baseline Scan:** Conducted the first comprehensive compliance scan, establishing a quantitative security baseline. The scan of a development host (`mgmt-agents01`) against the CIS Ubuntu 24.04 benchmark yielded a **52% pass rate (142 passed, 128 failed)**, providing an immediate, actionable list for targeted hardening.

* **Strategic Impact:** This deployment provides a foundational SecOps capability, enabling continuous, evidence-based validation of security controls and providing real-time threat detection and analysis capabilities.

## 4. Consolidated Security Posture Baseline

* **Perimeter & Access Control:** The infrastructure's physical and network perimeter is hardened. The Cloudflare ZTNA tunnel is the sole method for remote access.
* **System Hardening:** All assets operate from a secure baseline (Windows CIS L1 via GPO, Linux CIS L2 via Golden Image).
* **Quantitative Compliance Baseline:** Initial Wazuh SCA scans provide a quantitative starting point for ongoing hardening, with a 52% pass rate on a development host against the CIS Ubuntu benchmark.
* **Continuous Vulnerability Detection:** The Wazuh platform is actively identifying potential vulnerabilities, providing a baseline for creating a systematic patch and remediation strategy.

## 5. Overall Outcome & Next Steps

This initiative successfully implemented the foundational identity, access, and security-policy control planes. With a verifiable security baseline and continuous monitoring now in place, the immediate focus shifts to applying these new controls at the application layer and remediating initial security findings.

### **Immediate Priorities**

1. **Implement Role-Based Access Control (RBAC) Across the Application Stack:**
    * **Objective:** Apply the new, granular IAM framework to all internal services to enforce the defined security boundaries at the application layer.
    * **Scope:** Integrate OIDC/SAML with Azure AD for services such as Gitea, Kubernetes, Proxmox VE, PostgreSQL, and other management UIs.
2. **Remediate Baseline Security Findings:**
    * **Objective:** Use the initial Wazuh SCA and vulnerability scan data to create and execute a remediation plan.
    * **Scope:** Prioritize and address the 128 failed CIS controls and any critical/high vulnerabilities on the base Ubuntu image to improve the compliance score.
3. **Address Documentation and Knowledge Management Debt:**
    * **Objective:** Formally document all new architectures, configurations, and operational procedures to ensure long-term maintainability, auditability, and team readiness.
